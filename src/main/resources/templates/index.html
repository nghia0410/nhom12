<!doctype html>
<html lang="en">

<head>
    <title>Hello, world!</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <!--     Fonts and icons     -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <!-- Material Kit CSS -->
    <link href="/client/assets/css/material-kit.css?v=3.0.0" rel="stylesheet" />

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Delicious+Handrawn&family=Freehand&display=swap');
    </style>
</head>

<body>
<!-- Navbar Transparent -->
<nav class="navbar navbar-expand-lg position-absolute top-0 z-index-3 w-100 shadow-none my-3 navbar-transparent">
    <div class="container">
        <a class="navbar-brand  text-white " href="https://demos.creative-tim.com/material-kit/presentation" alt="logo" style="font-family: Freehand, cursive;
        font-weight: 400;font-style: normal; font-size:2em">
            Restaurant Location
        </a>
        <button class="navbar-toggler shadow-none ms-2" type="button" data-bs-toggle="collapse" data-bs-target="#navigation" aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon mt-2">
          <span class="navbar-toggler-bar bar1"></span>
          <span class="navbar-toggler-bar bar2"></span>
          <span class="navbar-toggler-bar bar3"></span>
        </span>
        </button>
        <div class="collapse navbar-collapse w-100 pt-3 pb-2 py-lg-0 ms-lg-12 ps-lg-5" id="navigation">
            <ul class="navbar-nav navbar-nav-hover ms-auto">
                <li class="nav-item dropdown dropdown-hover mx-2 ms-lg-6">
                </li>

                <li class="nav-item dropdown dropdown-hover mx-2">
                    <a class="nav-link ps-2 d-flex cursor-pointer align-items-center" id="dropdownMenuBlocks" data-bs-toggle="dropdown" aria-expanded="false" href="/admin">
                        <i class="material-icons opacity-6 me-2 text-md">account_circle</i>
                        Page Admin
                        <img src="/client/assets/img/down-arrow-dark.svg" alt="down-arrow" class="arrow ms-auto ms-md-2 d-lg-none d-block">
                    </a>
                </li>

                <li class="nav-item dropdown dropdown-hover mx-2" id="signInNavItem">
                    <a class="nav-link ps-2 d-flex cursor-pointer align-items-center" href="/sign-in" id="dropdownMenuDocs" data-bs-toggle="dropdown" aria-expanded="false">Sign In</a>
                </li>
                <form th:action="@{/logout}" method="post" id="logoutForm">
                    <li class="nav-item ms-lg-auto my-auto ms-3 ms-lg-0 mt-2 mt-lg-0">
                        <button type="submit" class="btn btn-sm bg-gradient-primary mb-0 me-1 mt-2 mt-md-0">
                            <i class="fas fa-sign-out-alt mx-1"></i> Log out
                        </button>
                    </li>
                </form>
            </ul>
        </div>
    </div>
</nav>
<!-- End Navbar -->


<div class="page-header min-vh-80" style="background-image: url('https://images.unsplash.com/photo-1630752708689-02c8636b9141?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2490&q=80')">
    <span class="mask bg-gradient-dark opacity-6"></span>
    <div class="container">
        <div class="row">
            <div class="col-md-8 mx-auto">
                <div class="text-center">
                    <h1 class="text-white">Restaurant Location</h1>
<!--                    <h3 class="text-white">Subtitle</h3>-->
                </div>
            </div>
        </div>
    </div>
</div>
<div class="card card-body shadow-xl mx-3 mx-md-4 mt-n6">
    <div class="container">
        <div class="section text-center">
            <div class="row text-center py-2 mt-3">
                <div class="col-4 mx-auto">
                    <div class="input-group input-group-dynamic mb-4">
                        <input class="form-control" id="searchInput" placeholder="Search a location" type="text" style="z-index:100">
                        <button class="btn btn-outline-primary" type="button" id="searchButton">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </button>
                        <span>
                            <button onclick="returnToUserLocation()" class="btn btn-primary" style="margin-left: 5px">
                            <i class="fa-solid fa-location-crosshairs"></i>
                        </button>
                        </span>
                    </div>
                </div>
            </div>
            <div id="googleMap" style="width: 100%; height: 650px;"></div>
        </div>
    </div>
</div>
<footer class="footer pt-5 mt-5">
    <div class="container">
        <div class=" row">
            <div class="col-md-3 mb-4 ms-auto">
                <div>
                    <a href="https://www.creative-tim.com/product/material-kit">
                        <img src="/client/assets/img/logo-ct-dark.png" class="mb-3 footer-logo" alt="main_logo">
                    </a>
                    <h6 class="font-weight-bolder mb-4">Material Kit 2</h6>
                </div>
            </div>
            <div class="col-md-2 col-sm-6 col-6 mb-4">
                <div>
                    <h6 class="text-sm">Company</h6>
                    <ul class="flex-column ms-n3 nav">
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/presentation" target="_blank">
                                About Us
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/templates/free" target="_blank">
                                Freebies
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/templates/premium" target="_blank">
                                Premium Tools
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/blog" target="_blank">
                                Blog
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-md-2 col-sm-6 col-6 mb-4">
                <div>
                    <h6 class="text-sm">Resources</h6>
                    <ul class="flex-column ms-n3 nav">
                        <li class="nav-item">
                            <a class="nav-link" href="https://iradesign.io/" target="_blank">
                                Illustrations
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/bits" target="_blank">
                                Bits & Snippets
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/affiliates/new" target="_blank">
                                Affiliate Program
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-md-2 col-sm-6 col-6 mb-4">
                <div>
                    <h6 class="text-sm">Help & Support</h6>
                    <ul class="flex-column ms-n3 nav">
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/contact-us" target="_blank">
                                Contact Us
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/knowledge-center" target="_blank">
                                Knowledge Center
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://services.creative-tim.com/?ref=ct-mk2-footer" target="_blank">
                                Custom Development
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/sponsorships" target="_blank">
                                Sponsorships
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-md-2 col-sm-6 col-6 mb-4 me-auto">
                <div>
                    <h6 class="text-sm">Legal</h6>
                    <ul class="flex-column ms-n3 nav">
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/knowledge-center/terms-of-service/" target="_blank">
                                Terms & Conditions
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/knowledge-center/privacy-policy/" target="_blank">
                                Privacy Policy
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="https://www.creative-tim.com/license" target="_blank">
                                Licenses (EULA)
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-12">
                <div class="text-center">
                    <p class="text-dark my-4 text-sm font-weight-normal">
                        All rights reserved. Copyright © <script>
                        document.write(new Date().getFullYear())
                    </script> Material Kit by <a href="https://www.creative-tim.com" target="_blank">Creative Tim</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>
</body>

</html>
<head>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBrRkcBr2rmsuA_3TZMs2jVd8VVUsQ1ms4&callback=initMap" async defer></script>
</head>
<script>
function checkLoggedInStatus() {
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function() {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status === 200) {
                    var loggedIn = JSON.parse(xhr.responseText);
                    toggleAuthentication(loggedIn);
                } else {
                    console.error('Error occurred while checking logged-in status.');
                }
            }
        };
        xhr.open('GET', '/get-logged-in-status');
        xhr.send();
    }

    function toggleAuthentication(loggedIn) {
        var signInNavItem = document.getElementById("signInNavItem");
        var logoutForm = document.getElementById("logoutForm");

        if (loggedIn) { // Đã đăng nhập, chuyển sang trạng thái đăng xuất
            signInNavItem.style.display = "none";
            logoutForm.style.display = "block";
        } else { // Chưa đăng nhập, chuyển sang trạng thái đăng nhập
            signInNavItem.style.display = "block";
            logoutForm.style.display = "none";
        }
    }

    document.addEventListener("DOMContentLoaded", function() {
        checkLoggedInStatus();
    });
</script>
<script>
    var map;
    var currentMarker;
    var userLocation;

    function initMap() {
        // Khởi tạo bản đồ
        map = new google.maps.Map(document.getElementById('googleMap'), {
            zoom: 15
        });

        // Lấy vị trí hiện tại của người dùng nếu có
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                userLocation = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };

                // Đặt vị trí mặc định là vị trí hiện tại của người dùng
                map.setCenter(userLocation);

                // Thêm đánh dấu tại vị trí hiện tại của người dùng
                currentMarker = new google.maps.Marker({
                    position: userLocation,
                    map: map,
                    title: 'Vị trí của bạn',
                    animation: google.maps.Animation.DROP,
                    icon: {
                        url: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png', // Thay đổi màu của đánh dấu thành màu xanh
                    }
                });
            });
        } else {
            // Trình duyệt không hỗ trợ Geolocation API
            console.log('Trình duyệt không hỗ trợ Geolocation API');
        }

        // Xử lý sự kiện khi nhấn nút tìm kiếm
        document.getElementById('searchButton').addEventListener('click', function () {
            var geocoder = new google.maps.Geocoder();
            var address = document.getElementById('searchInput').value;

            // Tìm kiếm địa điểm theo địa chỉ nhập vào
            geocoder.geocode({'address': address}, function (results, status) {
                if (status === 'OK') {
                    // Lấy vị trí của địa điểm tìm kiếm được
                    var location = results[0].geometry.location;

                    // Di chuyển bản đồ đến vị trí tìm kiếm được
                    map.setCenter(location);

                    // Xoá đánh dấu hiện tại nếu có
                    if (currentMarker) {
                        currentMarker.setMap(null);
                    }

                    // Thêm đánh dấu tại vị trí tìm kiếm được
                    currentMarker = new google.maps.Marker({
                        position: location,
                        map: map,
                        title: address,
                        animation: google.maps.Animation.DROP,
                    });
                } else {
                    // Không tìm thấy địa điểm hoặc có lỗi xảy ra
                    console.log('Không tìm thấy địa điểm hoặc có lỗi xảy ra');
                }
            });
        });
    }
    var input = document.getElementById('searchInput');
    var autocomplete = new google.maps.places.Autocomplete(input);
    autocomplete.bindTo('bounds',map);


    google.maps.event.addListener(autocomplete, 'place_changed',function(){
        var place=autocomplete.getPlace();
        if (!place.geometry){
            return;
        }
        if (place.geometry.viewport) {
            map.fitBounds(place.geometry.viewport);
        } else {
            map.setCenter(place.geometry.location);
            map.setZoom(17);
        }

        marker.setPlace( ({
            placeId: place.place_id,
            location: place.geometry.location
        }));
    });
        // Hàm quay lại vị trí hiện tại của người dùng
    function returnToUserLocation() {
        if (userLocation) {
            map.setCenter(userLocation);

            // Kiểm tra xem marker của vị trí hiện tại đã tồn tại chưa
            if (currentMarker) {
                // Nếu đã tồn tại, xoá marker cũ
                currentMarker.setMap(null);
            }
            // Tạo mới marker của vị trí hiện tại với animation
            currentMarker = new google.maps.Marker({
                position: userLocation,
                map: map,
                title: 'Vị trí của bạn',
                animation: google.maps.Animation.DROP,
                icon: {
                    url: 'http://maps.google.com/mapfiles/ms/icons/green-dot.png', // Thay đổi màu của đánh dấu thành màu xanh
                }
            });
        }
    }

    // Gọi hàm initMap khi trang web tải xong
    window.onload = initMap;
</script>